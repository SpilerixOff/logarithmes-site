<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Certificat ‚Äì Spilerix</title>

  <style>
    :root{
      --violet:#a88bff; --or:#ffd166; --vert:#67ddb5;
      --bg1:#1a1125; --bg2:#08030f; --glass:rgba(255,255,255,.06);
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0}
    body{
      background: radial-gradient(circle at center,var(--bg1),var(--bg2));
      color:#fff; font-family:Poppins,system-ui,Segoe UI,Roboto,Arial;
      display:flex; align-items:center; justify-content:center; padding:18px;
      overflow:hidden; text-align:center;
    }
    canvas.bg{position:fixed; inset:0; z-index:-1}

    .card{
      width:min(900px,96%); padding:42px 56px; border-radius:24px;
      background:var(--glass); backdrop-filter: blur(10px);
      border:2px solid rgba(168,139,255,.55);
      box-shadow:0 0 36px rgba(168,139,255,.28);
      animation:pop .9s ease both;
    }
    @keyframes pop{from{opacity:0; transform:translateY(30px) scale(.98)} to{opacity:1; transform:none}}

    h1{margin:0 0 10px; font-size:2.4rem; color:#f5e6ff; text-shadow:0 0 18px var(--violet)}
    h2{margin:0 0 18px; color:#d7baff; font-size:1.25rem}
    .name{font-size:2rem; font-weight:800; color:var(--or); text-shadow:0 0 24px var(--or); margin:10px 0 16px}
    .score{font-size:1.35rem; color:var(--vert); margin:0 0 16px}
    .desc{max-width:560px; margin:0 auto 16px; opacity:.92; line-height:1.6}

    .row{display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:12px}
    .btn{
      background:linear-gradient(90deg,var(--violet),var(--vert));
      color:#0d0d18; font-weight:800;
      border:none; padding:12px 20px; border-radius:12px; cursor:pointer; transition:.2s;
    }
    .btn:hover{transform:scale(1.05); box-shadow:0 0 16px var(--violet)}

    footer{position:fixed; left:0; right:0; bottom:10px; text-align:center; color:var(--violet); opacity:.85; font-size:.9rem}

    /* Signature anim√©e */
    .signature{width:240px; height:86px; margin:18px auto 0}
    .signature path{
      stroke:var(--or); stroke-width:2; fill:none; stroke-linecap:round; stroke-linejoin:round;
      stroke-dasharray:400; stroke-dashoffset:400; animation:draw 3s ease forwards 1.1s;
    }
    @keyframes draw{to{stroke-dashoffset:0}}

    /* Mobile */
    @media (max-width:720px){
      .card{padding:24px}
      h1{font-size:1.9rem} .name{font-size:1.5rem}
    }
  </style>
</head>
<body>
  <!-- Fond anim√© particules dor√©es -->
  <canvas class="bg"></canvas>

  <div class="card" role="document" aria-label="Certificat de r√©ussite">
    <h1>üéì Certificat de r√©ussite</h1>
    <h2>Attribu√© √† :</h2>
    <div id="certName" class="name">√âl√®ve</div>
    <div id="scoreTxt" class="score">Score : 0%</div>

    <p class="desc">
      Ce certificat atteste que <b id="certName2">√âl√®ve</b> a termin√© avec succ√®s le test
      de compr√©hension des logarithmes, d√©montrant une bonne ma√Ætrise des r√®gles essentielles.
    </p>

    <!-- Anneau de score -->
    <canvas id="ring" width="190" height="190" style="margin:6px auto 12px; display:block;"></canvas>

    <div class="row" aria-label="Actions certificat">
      <button id="btnPdf" class="btn">üìÑ T√©l√©charger en PDF</button>
      <button class="btn" onclick="location.href='exercices.html'">üîÅ Refaire le test</button>
      <button class="btn" onclick="location.href='index.html'">üè† Accueil</button>
    </div>

    <!-- Signature anim√©e -->
    <svg class="signature" viewBox="0 0 500 200" aria-hidden="true">
      <path d="M15,120 Q90,30 165,120 T315,120 Q365,160 415,120 T485,120"/>
    </svg>
  </div>

  <footer>Site cr√©√© par <b>spilerix</b> ‚Äì pour comprendre avant de r√©ussir ‚ö°</footer>

  <script>
    /* ===== Particules dor√©es ===== */
    const C=document.querySelector('.bg'),X=C.getContext('2d'); let W,H,PS=[];
    function fit(){W=C.width=innerWidth; H=C.height=innerHeight}
    addEventListener('resize',fit); fit();
    class P{constructor(){this.x=Math.random()*W; this.y=Math.random()*H; this.r=1+Math.random()*2; this.v=.25+.6*Math.random(); this.a=.35+.45*Math.random()}
      u(){this.y-=this.v; if(this.y<0){this.y=H+12; this.x=Math.random()*W}}
      d(){X.globalAlpha=this.a; X.fillStyle="#ffd166"; X.beginPath(); X.arc(this.x,this.y,this.r,0,6.283); X.fill()}
    }
    for(let i=0;i<120;i++) PS.push(new P());
    (function loop(){X.clearRect(0,0,W,H); PS.forEach(p=>{p.u();p.d();}); requestAnimationFrame(loop)})();

    /* ===== Donn√©es nom + score ===== */
    const name  = (localStorage.getItem('certName') || '√âl√®ve').trim() || '√âl√®ve';
    const score = parseInt(localStorage.getItem('dernierScore') || '0', 10);
    document.getElementById('certName').textContent = name;
    document.getElementById('certName2').textContent = name;
    document.getElementById('scoreTxt').textContent  = `Score : ${isFinite(score)?score:0}%`;

    /* ===== Anneau anim√© de score ===== */
    const ring = document.getElementById('ring'), rctx = ring.getContext('2d');
    const R=75, CX=ring.width/2, CY=ring.height/2, Wline=11;
    let prog=0;
    function drawRing(p){
      rctx.clearRect(0,0,ring.width,ring.height);
      // fond
      rctx.beginPath(); rctx.arc(CX,CY,R,0,2*Math.PI); rctx.strokeStyle="#2b2b44"; rctx.lineWidth=Wline; rctx.stroke();
      // arc
      rctx.beginPath();
      rctx.arc(CX,CY,R,-Math.PI/2,-Math.PI/2 + 2*Math.PI*(p/100));
      rctx.strokeStyle="#67ddb5"; rctx.lineWidth=Wline; rctx.lineCap="round"; rctx.stroke();
      // texte
      rctx.fillStyle="#fff"; rctx.font="700 22px Poppins, Arial"; rctx.textAlign="center"; rctx.textBaseline="middle";
      rctx.fillText(`${Math.round(p)}%`, CX, CY);
    }
    (function anim(){drawRing(prog); if(prog<score){prog+=1; requestAnimationFrame(anim)}})();

    /* ===== PDF (simple & fiable via print) ===== */
    document.getElementById('btnPdf').onclick = () => {
      const w = window.open('', '_blank');
      w.document.write(`
        <html><head><title>Certificat Spilerix</title>
        <style>
          body{font-family:Poppins,Arial;background:#1a1125;color:#fff;text-align:center;padding:60px}
          .card{border:2px solid #a88bff;border-radius:20px;padding:36px;max-width:800px;margin:auto}
          h1{color:#f5e6ff} h2{color:#ffd166}
        </style></head>
        <body>
          <div class="card">
            <h1>üéì Certificat de R√©ussite</h1>
            <h2>Attribu√© √† : <b>${name}</b></h2>
            <p style="font-size:1.2rem;margin:10px 0 20px;">Score obtenu : <b>${isFinite(score)?score:0}%</b></p>
            <p>Ce certificat atteste la compr√©hension des logarithmes (r√®gles, domaines, changement de base).</p>
            <svg viewBox="0 0 500 200" width="260" style="margin-top:28px">
              <path d="M15,120 Q90,30 165,120 T315,120 Q365,160 415,120 T485,120"
                    stroke="#ffd166" stroke-width="2" fill="none"/>
            </svg>
            <p style="margin-top:30px;color:#a88bff;">Site cr√©√© par <b>spilerix</b> ‚Äì pour comprendre avant de r√©ussir ‚ö°</p>
          </div>
        </body></html>
      `);
      w.print();
    };
  </script>
</body>
</html>
